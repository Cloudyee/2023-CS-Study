# 캐시 메모리
<br/>

## 목차

1. 캐시 메모리란?
2. 작동 원리
    
    2-1. 캐시의 지역성
    
    2-2. 캐시미스
    
3. 캐싱 라인
4. 예상 면접질문
<br/>

## 캐시 메모리란?

- 속도가 빠른 장치와 느린 장치 간의 속도차에 따른 병목 현상을 줄이기 위한 범용 메모리
- 상대적으로 속도가 빠른 CPU와 상대적으로 속도가 느린 메모리 사이에서 역할을 수행한다.
- CPU가 주기억장치에서 저장된 데이터를 읽어올 때, 자주 사용하는 데이터를 캐시 메모리에 저장한 뒤, 다음에 이용할 때 주기억장치가 아닌 캐시 메모리에서 먼저 가져오면서 속도를 향상시킨다.
- 속도라는 장점을 얻지만, 용량이 적기도 하고 비용이 비싼 점이 있다.
<br/>

## 작동 원리

### 캐시의 지역성

- 캐시 메모리는 **캐시의 지역성(Cache Locality)**을 ****이용해서 메모리에서 데이터를 가져온다.
- 캐시의 지역성이란 데이터에 대한 접근이 시간적 혹은 공간적으로 가깝게 발생하는 것을 말한다. 캐시의 적중률(Hit rate)을 극대화하여 캐시가 효율적으로 동작하기 위해 사용되는 성질이다.

<br>

- 캐시의 지역성은 **공간 지역성(Spatial Locality)**과 **시간 지역성(Temporal Locality)**으로 나뉜다.
    - **공간 지역성** : 최근에 사용했던 데이터와 인접한 데이터가 참조될 가능성이 높다는 특성
    - **시간 지역성** : 최근에 사용했던 데이터가 재참조될 가능성이 높은 특성

- 캐시에 데이터를 저장할 때는, 이러한 참조 지역성(공간)을 최대한 활용하기 위해 해당 데이터뿐만 아니라, 옆 주소의 데이터도 같이 가져와 미래에 쓰일 것을 대비한다.
- CPU가 요청한 데이터가 캐시에 있으면 'Cache Hit', 없어서 DRAM에서 가져오면 'Cache Miss' 라고 한다.
<br/>

### 캐시 미스

1. **Cold miss**
    
    해당 메모리 주소를 처음 불러서 나는 미스
    
2. **Conflict miss**
    
    캐시 메모리에 A와 B 데이터를 저장해야 하는데, A와 B가 같은 캐시 메모리 주소에 할당되어 있어서 나는 미스 (direct mapped cache에서 많이 발생)
    
3. **Capacity miss**
    
    캐시 메모리의 공간이 부족해서 나는 미스 (Conflict는 주소 할당 문제, Capacity는 공간 문제)
<br/>
    

## 캐싱라인

- 캐시 메모리는 메인 메모리에 비해 크기가 매우 작기 때문에 메인 메모리와 1:1 매칭이 불가능하다.
- 캐시가 아무리 CPU에 가깝게 위치하더라도, 데이터가 캐시 내의 어느 곳에 저장되어 있는지 찾기가 어려워 모든 데이터를 순회해야 한다면 캐시의 장점을 잃기 때문에 쉽게 찾을 수 있는 구조가 필요하다.
- 따라서, **캐시에 데이터를 저장할 때 특정 자료구조를 사용하여 묶음**으로 저장하는데, 이를 **캐싱 라인(Caching Line)**이라고 한다. 빈번하게 사용되는 데이터의 주소들이 흩어져 있기 때문에 캐시에 저장하는 데이터에는 데이터의 주소 등을 기록해둔 태그를 달아둘 필요가 있다. 이러한 태그들의 묶음을 의미한다.

캐싱 라인은 다음과 같은 매핑 방법을 사용한다.

<br/>

**1. Direct Mapping**

직접 매핑으로, 메인 메모리를 일정한 크기의 블록으로 나누어 각각의 블록을 캐시의 정해진 위치에 매핑하는 방식이다. 가장 간단하고 구현도 쉽다.

하지만 적중률이 낮아질 수 있다. 또 동일한 캐시 메모리에 할당된 여러 데이터를 사용할 때 충돌이 발생하게 되는 단점이 있다.

<p align="center"><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FKWMR2%2FbtrgjyIn1ns%2FmvER1WQu1w7kI4BuHbQCqk%2Fimg.png"
width="600px" height="400px"/></p>
<br/>

**2. Full Associative Mapping**

캐시 메모리의 빈 공간에 마음대로 주소를 저장하는 방식이다. 저장하는 것은 매우 간단하지만, 원하는 데이터가 있는지 찾기 위해서는 모든 태그를 병렬적으로 검사해야 하기 때문에 복잡하고 비용이 높다는 단점이 있다.

**3. Set Associative Mapping**

Direct Mapping과 Full Associative Mapping의 장점을 결합한 방식이다.

빈 공간에 마음대로 주소를 저장하되, 미리 정해둔 특정 행에만 저장하는 방식이다. Direct에 비해 검색 속도는 느리지만 저장이 빠르고 Full에 비해 저장이 느리지만 검색은 빠르다.

주로 사용하는 방식이다.
<br/>
<br/>

## 예상 면접질문

- 캐시 메모리란 무엇인가요?
- 캐시의 지역성에 대해서 설명해 주세요
- 캐싱 라인이란 무엇인가요?
- 캐싱이 무엇인가요?
