# Interrupt
<br/>

## 목차

1. 인터럽트란?
2. 인터럽트의 종류
3. 인터럽트 동작 과정
4. 인터럽트와 폴링
5. 인터럽트 우선순위
6. 예상 면접 질문
<br/>

## 인터럽트란?

- 프로그램을 실행하는 도중에 예기치 않은 상황이 발생할 경우 현재 실행 중인 작업을 즉시 중단하고, 발생된 상황에 대한 우선 처리가 필요함을 CPU에게 알리는 것
- 지금 수행 중인 일보다 더 중요한 일(ex. 입출력, 우선 순위 연산 등)이 발생하면 그 일을 먼저 처리하고 나서 하던 일을 계속해야한다.
- 예를 들면, 키보드의 키를 하나 누르면, 눌려진 키 코드 값이 키보드 버퍼에 입력된 후 CPU에 인터럽트가 걸린다. 그럼 현재 처리하던 작업에 대한 정보를 수집하여 저장한 뒤에 인터럽트 서비스 루틴(Interrupt Service Routine)을 수행한다.(이 경우에는 키보드 버퍼에 있는 키 코드 값을 가져가는 일을 한다.) 이렇게 인터럽트 처리를 마친 후에는 다시 이전에 처리하던 작업으로 돌아간다.
<br/>

## 인터럽트 종류

### 하드웨어 인터럽트

- 일반적으로 인터럽트를 이르는 말
- CPU외부로부터의 인터럽트 요구 신호에 의해 발생되는 인터럽트

- 입출력 인터럽트 (I/O interrupt) - 입출력 작업의 종료나 입출력 오류에 의해 CPU의 기능이 요청됨
- 정전,전원 이상 인터럽트(Power fail interrupt) - 전원 공급의 이상
- 기계 착오 인터럽트(Machine check interrupt) - CPU의 기능적인 오류
- 외부 신호 인터럽트(External interrupt) - I/O 장치가 아닌 오퍼레이터나 타이머에 의해 의도적으로 프로그램이 중단된 경우

### 소프트웨어 인터럽트

- CPU내부에서 자신이 실행한 명령이나 CPU의 명령 실행에 관련된 모듈이 변화하는 경우 발생
- trap 또는 exception 이라고도 함
- 프로그램의 오류에 의해 생기는 인터럽트

- 프로그램 검사 인터럽트 (Program check interrupt)
    - 0으로 나누는 경우
    - OverFlow/UnderFlow
    - 잘못된 메모리 참조
- SVC(Supervisor Call: 감시프로그램 호출)인터럽트
    - 사용자가 프로그램을 실행시키거나 supervisior을 호출하는 동작을 수행하는 경우
    - 프로그래머에 의해 코드로 짜인 감시 프로그램을 호출하는 방식
<br/>

## 인터럽트 우선순위
  <br/>
  1. **전원 이상**(Power fail)<br/>
  2. **기계 착오**(Machine Check)<br/>
  3. **외부 신호**(External)<br/>
  4. **입출력**(I/O)<br/>
  5. **명령어 잘못**<br/>
  6. **프로그램 검사**(Program Check)<br/>
  7. **SVC**(SuperVisor Call)<br/>
  <br/>

- **여러 장치에서 인터럽트가 동시에 발생하거나 인터럽트 서비스 루틴 수행 중 인터럽트가 발생한 경우 우선순위 판별 필요**
- 일반적으로 하드웨어 인터럽트가 소프트웨어 인터럽트보다 우선 순위가 높고,
- 일반적으로 내부 인터럽트 보다 외부 인터럽트가 우선 순위가 높다.
<br/>

## 인터럽트 동작 과정

<p align="center"><img src="https://github.com/woorifisa-member/2023-CS-Study/blob/main/OS/img/Interrupt.png?raw=true"
width="800px" height="300px"/></p>
<br/>

주 프로그램이 실행되다가 인터럽트가 발생했다.

현재 수행 중인 프로그램을 멈추고, 상태 레지스터와 PC 등을 스택에 잠시 저장한 뒤에 인터럽트 서비스 루틴으로 간다. (잠시 저장하는 이유는, 인터럽트 서비스 루틴이 끝난 뒤 다시 원래 작업으로 돌아와야 하기 때문)
<br/>

## 인터럽트와 폴링

만약 **인터럽트 기능이 없었다면**, 컨트롤러는 특정한 어떤 일을 할 시기를 알기 위해 계속 체크를 해야 한다. (이를 폴링(Polling)이라고 한다)

**폴링**을 하는 시간에는 원래 하던 일에 집중할 수가 없게 되어 많은 기능을 제대로 수행하지 못하는 단점이 있었다.

<br/>

즉, 컨트롤러가 입력을 받아들이는 방법(우선순위 판별방법)에는 두가지가 있다.

- **폴링 방식**
    
    사용자가 명령어를 사용해 입력 핀의 값을 계속 읽어 변화를 알아내는 방식
    
    인터럽트 요청 플래그를 차례로 비교하여 우선순위가 가장 높은 인터럽트 자원을 찾아 이에 맞는 인터럽트 서비스 루틴을 수행한다. (하드웨어에 비해 속도 느림)
    
- **인터럽트 방식**
    
    MCU 자체가 하드웨적으로 변화를 체크하여 변화 시에만 일정한 동작을 하는 방식
    

인터럽트 방식은 하드웨어로 지원을 받아야 하는 제약이 있지만, 폴링에 비해 신속하게 대응하는 것이 가능하다. 따라서 **실시간 대응**이 필요할 때는 필수적인 기능이다.

즉, 인터럽트는 **발생시기를 예측하기 힘든 경우에 컨트롤러가 가장 빠르게 대응할 수 있는 방법**이다.
<br/>
<br/>

## 예상 면접질문

- 인터럽트란 무엇인가?
- 알고있는 인터럽트의 예시를 말해보시오
- 인터럽트와 폴링의 차이?
